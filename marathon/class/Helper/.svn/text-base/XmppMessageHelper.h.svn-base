//
//  XmppMessageHelper.h
//  Match
//
//  Created by wangweiqing on 13-01-14.
//  Copyright 2013年 __MyCompanyName__. All rights reserved.
//

#import <Foundation/Foundation.h>
#import "ClientConnection.h"
#import "XMPP.h"

#define MAX_MESSAGE_COUNT     10000

@interface XmppMessageHelper : NSObject {

    NSMutableArray *arrayReceivedMessage;//保存所有收到的消息
    NSMutableArray *arraySendMessage;    //保存所有未发送成功的消息
}

@property (nonatomic, retain) NSMutableArray *arraySendMessage;//保存所有未发送成功的消息
@property (nonatomic, retain) NSMutableArray *arrayReceivedMessage;
@property (nonatomic, retain) NSString *currentTime;

- (NSMutableArray*)getRcvMsgByJID:(NSString*)fromXmppJID;

//消息发送
- (BOOL)hasToSendMessage;
- (NSString*)sendMessageText:(NSString*)msgContent FromXmppJID:(NSString*)fromXmppJID ToXmppJID:(NSString*)toXmppJID clientMsgID:(NSString*)clientMsgID ;
- (NSString*)sendXmppMessageText:(NSString*)msgContent FromXmppJID:(NSString*)fromXmppJID ToXmppJID:(NSString*)toXmppJID clientMsgID:(NSString*)clientMsgID ContentType:(NSString*)contentType PicUrl:(NSString*)picUrl ObjectID:(NSString*)objectID;

- (void)addOneSendMessage:(NSXMLElement *)xmppMessage;
- (void)removeOneSendMessage:(NSXMLElement *)xmppMessage;
- (void)sendAllMessage;
- (void)removeAllMessage;

//消息接收
-(void)xmppNewMessageReceived:(NSDictionary *)messageDict;//消息接收代理

- (NSDictionary*)getLastRcvMsgByJID:(NSString*)fromXmppJID;//获取特定用户的最后一条未读消息
- (NSMutableArray*)getRcvMsgByJID:(NSString*)fromXmppJID;//获取特定用户的未读消息
//- (NSInteger)getRcvMsgCountByJID:(NSString*)fromXmppJID;//获取特定用户的未读消息数量
- (void)cleanRcvMsgByJID:(NSString*)fromXmppJID;//清除特定用户的未读消息
- (void)cleanRcvMsgArray;
- (NSInteger)getAllRcvMsgCount;
- (void)removeOneSendMessageByClientMsgid:(NSString *)deleteMsgID;


@end
